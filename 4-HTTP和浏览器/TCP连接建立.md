# tcp连接建立

## 三次握手

1. 客户端：发送syn包（seq=j）到服务器， 并进入 SYN_SEND 状态；
2. 服务端：确认客户端的syn包，ack = j+1, 同时自己发送一个syn包（seq=k），并进入 SYN_REVE 状态；
3. 客户端：收到服务器的 syn + ack包，并且发送 syn = k+1, 双方进入 ESTABLISHED状态；



## https

先三次握手建立TCP连接
再通过 TLS 四次握手，交换双方的密钥
TLS是非对称加密，
- 公钥（public key）：公开可见，用于加密数据。
- 私钥（private key）：只自己可见，用于解密。



## 四次挥手
           FIN
        ------->

           ACK
        <-------
客户端              服务器
           FIN
        <-------

           ACK
        ------->


1. 客户端发送 `FIN`;
2. 服务器向客户端发送一个确认序号`ACK`，同时通知自己相应的应用程序：对方要求关闭连接（先发送ACK的目的是为了防止在这段时间内，对方重传FIN报文段）;
3. 服务器的向客户端送一个`FIN`报文段;
4. 客户端收到这个FIN报文段后，向主机B发送一个`ACK`表示连接彻底释放;



