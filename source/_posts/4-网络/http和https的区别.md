## Http和https区别


|                | HTTP                             | HTTPs                                                 |
|----------------|----------------------------------|-------------------------------------------------------|
| 证书           | 不需要                           | ca                                                    |
| 建立连接的过程 | 客户端和服务器端三次握手建立链接 | 见下描述                                              |
| 端口           | 建立在TCP                        | 443                                                   |
| 简介           | 建立在TCP协议上                  | HTTPS 经由 HTTP 进行通信，但利用 SSL/TLS 来加密数据包 |
| 速度           | 快一点，三次握手，9个包          | 慢一点，除了TCP的三个包，还有SSL产生的9个包，共12个包 |
| 报文           | 明文                             | 使用随机key加密后传输                                 |


## HTTP 三次握手

<details>
<summary>click here</summary>



三次握手发生在网络层，如果是UDP包则不需要握手直接发送;

三次握手的过程，很像《三国演义》中孙策和太史慈第一次相遇的场景，握手的目标是为了确认双方的身份并确认链接成功建立;


1. 客户端发送 syn包(syn = x), 并进入 SYN_SEND
      | syn: 1    | ack: 0  |
      |-----------|---------|
      | 顺序号: x | 序列号: |

2. 服务器收到syn包之后，必须确认客户的syn包(即 ack = x+1 ), 同时自己也发送一个 syn 包(syn = y), 即 SYN+ACK包; 此时服务器进入SYN_RECV 状态；

      | syn: 1    | ack: 1      |
      |-----------|-------------|
      | 顺序号: y | 序列号: x+1 |

3. 客户端收到服务器的 SYN+ACK 包之后, 向服务器发送一个确认包 ACK(ack=k+1), 此包发送完毕，客户度和服务器进入 ESTABLISHED 状态，完成三次握手。

      | syn: 0      | ack: 1      |
      |-------------|-------------|
      | 顺序号: x+1 | 序列号: y+1 |

</details>

## HTTP 四次挥手


<details>
<summary>click here</summary>

四次挥手是为了通信双方安全断开链接


<div style="width: 50%;margin: 0 auto; display: flex;justify-content: space-between;">
   <span>客户端</span>
   <span>服务器端</span>
</div>

![](images/http和https的区别-21-08-29-08-29-58.png)


</details>




## 非对称加密

1. 只有经过A的公钥加密过的信息，只有经过A的私钥才能解密;
2. 任何有公钥的人，可以确认对方发送的信息是被私钥加密过的;








## HTTPs的加密过程

<details>
<summary>click here</summary>

![](images/http和https的区别-21-08-29-08-39-25.png)


1. 客户端向服务器发起请求，然后连接到server的 **443端口**；
2. 服务器将**CA机构签发的证书(证书包含公钥)**发送到客户端；
3. 客户端收到公钥，生成 **随机密钥**, 并使用服务器端提供的公钥对**随机密钥**进行加密后，传送到服务器；
4. 服务器收到后，使用 **私钥**，对数据包进行解密, 得到**随机密钥**;
5. 现在，只有通信双方才知道这个 **随机密钥**,所以后续的数据传输都使用该 **随机密钥**进行加密，保证数据的安全性;






</details>








## 介绍下OAuth

1. 客户端向用户申请给予授权，
2. 用户同意给予授权；
3. 客户端使用该授权，向认证服务器申请令牌；
4. 认证服务器对客户端进行认证以后，确认无误，同意发放令牌；
5. 客户端使用令牌向资源服务器发起资源请求；
6. 资源服务器校验令牌无误，返回资源；

