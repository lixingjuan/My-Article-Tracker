<html><body><h2 id="是同步更新么？">是同步更新么？</h2>
<h2 id="是批量更新么？">是批量更新么？</h2>
<ol>
<li>在外部是批量更新
<strong>click, 触发渲染1次</strong></li>
</ol>
<pre><code class="language-jsx">const onClick = () =&gt; {
  setcount((pre) =&gt; pre + 1);
  setcount((pre) =&gt; pre + 1);
  setcount((pre) =&gt; pre + 1);
};
</code></pre>
<ol start="2">
<li>在setTimeout, Promise等中, 不是批量更新
<strong>触发渲染3次</strong></li>
</ol>
<pre><code class="language-jsx">  const onClick = () =&gt; {
    setcount((pre) =&gt; pre + 1);
    setTimeout(() =&gt; {
     setcount((pre) =&gt; pre + 1);
     setcount((pre) =&gt; pre + 1);
    }, 0);
  };
</code></pre>
<ol start="3">
<li>强制批量更新批量更新，ReactDOM.unstable_batchedUpdates
<strong>触发渲染2次</strong></li>
</ol>
<pre><code class="language-jsx">  const onClick = () =&gt; {
    setcount((pre) =&gt; pre + 1);
    setTimeout(() =&gt; {
      unstable_batchedUpdates(() =&gt; {
        setcount((pre) =&gt; pre + 1);
        setcount((pre) =&gt; pre + 1);
      });
    }, 0);
  };
</code></pre>
</body></html>